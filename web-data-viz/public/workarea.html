<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="./imagens/SpecialE.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpecialE | Area de Trabalho</title>

    <link rel="stylesheet" href="./css/workarea.css">
    <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap"
        rel="stylesheet">

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>

    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Barra de navegação -->
    <div id="navbar">
        <!-- Logo da barra de navegação -->
        <div id="nav_logo">
            <img id="logo" src="./imagens/SpecialE.png" alt="SpecialE" href="index.html">
        </div>
        <!-- Links de navegação -->
        <div id="nav_link">
            <a id="link_home" class="link" href="index.html">SpecialE</a>
            <a id="link_servicos" class="link" href="mural.html">Mural</a>
            <a id="link_home" class="link" href="dash.html">Dashboard</a>
            <a id="link_home" class="link" href="pre_quiz.html">Quiz</a>
            <a id="link_login" class="link-button" href="login.html">Login</a>
        </div>
    </div>

    <!-- Seção principal -->
    <section class="home">
        <!-- Primeira tela com imagem -->
        <div id="tela1">
            <p id="p_tela1">
                <img class="foto" src="./imagens/dia-do-autismo-a-importancia-da-educacao-infantil-para-alunos-com-o-transtorno_g.png" alt="imagem do autismo">
            </p>
        </div>
        
        <!-- Segunda tela com links para dashboards e mural -->
        <div id="tela2">
            <div class="left">
                <div class="desc_dash"></div>
                <div class="button_dash"><a href="./dash.html">io</a></div>
            </div>
            <div class="right">
                <div class="desc_mural"></div>
                <div class="button_mural"><a href="./mural.html">oi</a></div>
            </div>
        </div>
    </section>

    <!-- Seção adicional -->
    <section class="hom">
        <!-- Ranking com quatro elementos -->
        <div class="ranking">
            <div class="pr" id="rank1"></div>
            <div class="pr" id="rank2"></div>
            <div class="pr" id="rank3"></div>
            <div class="pr" id="rank4"></div>
        </div>

        <!-- Informações do gráfico -->
        <div class="chart-info">
            <div class="sim">
                <p>60%</p>
                <p>Sim</p>
            </div>
            <div class="nao">
                <p>40%</p>
                <p>Não</p>
            </div>
        </div>
    </section>

    <!-- Rodapé -->
    <div id="footer">
        <div id="grupo">
            <!-- Informações de contato por e-mail -->
            <div id="email">
                <a href="mailto:luiz.cunha@sptech.school"><img src="imagens/o-email.png" alt="email"></a>
                <h2 class="tituloFooter">E-mail</h2>
                <p class="subtituloFooter">luiz.cunha@sptech.school</p>
            </div>
            <!-- LinkedIn -->
            <div id="linkedin">
                <a href="https://www.linkedin.com/in/luiz-gustavo-dantas-da-cunha-b23a601b5/"><img src="imagens/logotipo-do-linkedin.png" alt="linkedin"></a>
                <h2 class="tituloFooter">LinkedIn</h2>
                <p class="subtituloFooter">@LuizGustavoDantas</p>
            </div>
            <!-- GitHub -->
            <div id="github">
                <a href="https://github.com/LuizCunha-G"><img src="imagens/github.png" alt="GitHub"></a>
                <h2 class="tituloFooter">Github</h2>
                <p class="subtituloFooter">@LuizCunha-G</p>
            </div>
        </div>
    </div>
</body>


</html>

<script>
    function fetchGrafico() {
        // Faz uma requisição GET para o endpoint "/result/buscandoQ1"
        fetch("/result/buscandoQ1", {
            method: "GET", // Define o método da requisição como GET
            headers: {
                "Content-Type": "application/json" // Define o tipo de conteúdo como JSON
            }
        }).then(function (response) {
            console.log("Estou no then do gráfico!");
    
            // Verifica se a resposta da requisição é bem-sucedida
            if (response.ok) {
                console.log(response)
                // Converte a resposta para JSON e processa os dados
                response.json().then(function (dados) {
                    console.log(`Dados recebidos ${JSON.stringify(dados)}` );
                    // Chama a função para atualizar o gráfico com os dados recebidos
                    atualizarGrafico(dados);
                });
            } else {
                // Caso a resposta não seja bem-sucedida, loga um erro
                console.log("Houve um erro ao capturar os dados do gráfico!");
                console.error("Status da resposta:", response.status);
            }
        }).catch(function (erro) {
            // Loga qualquer erro que ocorra durante a requisição
            console.error("Erro na requisição:", erro);
        });
    }
        
    function atualizarGrafico(dados) {
        console.log(dados);
        
        // Limpa os dados antigos dos elementos HTML
        top1.innerHTML = '';
        top2.innerHTML = '';
        top3.innerHTML = '';
        top4.innerHTML = '';
        
        // Ordena os dados pelo campo 'answers' em ordem decrescente
        dados.sort((a, b) => b.answers - a.answers);
        
        // Atualiza os elementos HTML com os novos dados
        top1.innerHTML = `${dados[0].Q1}: ${dados[0].answers}`;
        top2.innerHTML = `${dados[1].Q1}: ${dados[1].answers}`;
        top3.innerHTML = `${dados[2].Q1}: ${dados[2].answers}`;
        top4.innerHTML = `${dados[3].Q1}: ${dados[3].answers}`;
        
        console.log(dados, 'NA SEQUÊNCIA');
    }
        
    // Chama a função para atualizar o gráfico ao carregar a página
    document.addEventListener('DOMContentLoaded', fetchGrafico);
    
    // (Comentado: Atualiza o gráfico a cada 30 segundos)
    // setInterval(fetchGrafico, 30000);
    
    </script>
    
    
   